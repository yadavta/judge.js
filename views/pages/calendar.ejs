<!DOCTYPE html>
<html>

<head>
  <%- include ("../partials/header.ejs") %>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/fullcalendar@5.5.1/main.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.5.1/main.css" rel="stylesheet" />
</head>

<body>
  <%- include ("../partials/nav.ejs") %>
  <div class="section">
    <div id='calendar'></div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      let dbEvents = [];
      axios.get("api/tournaments")
        .then(function(result) {
          console.log(result);
          let i = 0;
          while (i < result.data.length) {
            let tData = result.data[i];
            let appendable = {
              title: tData.tournamentName,
              start: tData.startDate,
              end: tData.endDate,
              allDay: true,
              display: 'background'
            };
            dbEvents.push(appendable);
            i++;
          }
          console.log("the events array is:");
          console.log(dbEvents);
          var calendarEl = document.getElementById('calendar');

          var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            events: dbEvents
          });
          console.log("made calendar object")

          calendar.render();

          console.log(calendar.getEvents())
        });

    });

  </script>

</body>

</html>
